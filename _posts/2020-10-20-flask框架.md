---
layout:     post
title:      flask框架
subtitle:   初步接触
date:       2020-10-20
author:     BY lxl
header-img: img/title/数据库权限.jpg
catalog: true
tags:
    - flask
---

#  接触flask框架

##  1  .flask基础文件

- ```python
  from flask import Flask
  #创建一个flask对象app
  app = Flask(__name__)
  #绑定路由
  @app.route('/')
  def index():
      return '第一个flask页面'
  ```

##  2,基本架构，没有写开发调试等setting设置

[![Bp5eRx.png](https://s1.ax1x.com/2020/10/20/Bp5eRx.png)



## 2，flask框架中常使用的库

##  蓝图注册 方便管理多个路由

```python
from flask import Blueprint 
#创建蓝图，蓝图可实现多种flask对象操作，但需要在app中注册蓝图
index1 = Blueprint('index1',__name__)
#z = 0
@index1.route('/',methods=["GET","POST"])
def xxx（）。。
#注册蓝图
app.register_blueprint(index1)
```

##  执行者 ,绑定flask对象 及迁移命令

```python
from flask_script import Manager
manager.add_command('db',MigrateCommand)
#这里的db是迁移命令的对象，名字可以随便取，但是需要保持一致。
```

##  render_template渲染函数

- >将所有的html文件在template文件夹下创建，template文件夹是flask指定的渲染文件夹

  ```python
  from flask import rander_template
  render_tenplate('index.hmtl')
  #渲染index.html使得该index页面可以被显示
  ```

##  数据库的迁移

###  当数据库新增字段删除字段等操作时，不能将整个数据库删除再创建，这时使用迁移来完成

```python
from flask_migrate import MigrateCommand,Migrate
#创建迁移对象
migrete = Migrate()
#初始化迁移对象
# 创建一个Migrate对象migrate并关联对应的应用程序类对象app和数据库管理类对象db
migrete.init_app(app, db)
```

- > 将MigrateCommand命令加入到manager对象中,这样就可以在命令行中进行数据库迁移的相关命令.
  >
  > 这里的<em>db是迁移命令的对象</em>>，名字可以随便取，但是需要保持一致。

  ```python
  manager.add_command('db',MigrateCommand)
  '''
  manager.add_command('dbbb',MigrateCommand)
  python manage.py dbbb upgrate
  '''
  ```

  

>python manage.py db init：初始化一个迁移脚本的环境，只需要执行一次，只创建了一个文件夹，数据库没有初始化。
>python manage.py db migrate：将模型生成迁移文件，只要模型更改了(增加一列)，就需要执行一遍这个命令。
>python manage.py db upgrade：将迁移文件真正的映射到数据库中,创建表格。每次运行了migrate命令后，就记得要运行这个命令。

直接在modols中的数据库表中进行增删改查 每次操作之后执行

- 1，python manage.py db migrate
- 2，python  manage.py db upgrade

即可

##  数据库连接

- >初始化SQLALCHEMY对消db

```python
from flask_sqlalchemy import SQLALchemy
db = SQLALchemy()
#创建连接数据库的url url格式为
#数据库+驱动：//用户名:密码@主机:端口/具体的哪一个库
app.config['SQLALCHEMY_DATABASE_URL']=''
# 追踪数据库修改的配置，如果为True，那么数据库在数据操作的时候，会向外发出信号
app.config['SQLALCHEMY_TRACK_MODIFICATIONS']=False
db.init_app(app=app)
```

- >增删改查

  ```python
  #增
  db.session.add()
  db.session.
  ```

  

#  route（）映射路由的基本规则

- flask对象app和蓝图对象blue都可以绑定route。

  ```python
  @blue.route('/user')
  def index():
  return 'user'
  ```

  - route('/') 本机目录 既127.0.0.1

  - 路由参数获取<>

    - 语法<<converter:name>>

      > converter指的是类型，name是他的名字,可以被装饰的函数获取

    - coverter

      - int

        >route('/user/<<int:id>>')  127.0.0.1/int类型， 即可跳转此路由

      - float

        > route('/user/<<float:id>>') 

      - string(以/作为结尾 ) 

        >route('/user/<<string:id>>') 
        >
        >127.0.0.1/user/asohdiahsdoahds/

      - path(没结尾)

        >route('/user/<<path:id>>') 
        >
        >127.0.0.1/user/ahashdhiaduhu/aosihdhaos/adoiasod/aoipsdhihajs
        >
        >都可以跳转该路由

- 可以多个路由同时映射一个函数

  - ```python 
    route('/user/<<string:id>>') 
    route('/user/<<int:id>>') 
    def index(id):
        if type(id)==int:
            return '这是一个int'
        if type(id)==string:
    		return '这是一个string'
    ```

    >此时127.0.0.1/user/8    127.0.0.1/user/aoksdj都可以

